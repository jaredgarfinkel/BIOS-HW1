---
title: "BIOS_HW#1"
author: "Jared Garfinkel"
date: "9/13/2019"
tables: yes
output: html_document
---

#Problem 1

This is the solution for Problem 1

```{r load libraries}
library(tidyverse)
library(arsenal)
library(dplyr)
library(knitr)
```

##Section a

This is a solution for section a.

There is a top row of text that can be ignored for the purposes of creating a table.

```{r import doc}

exercise <- read.csv("C:\\Users\\jared\\OneDrive\\Fall 2019\\Biostatistics\\HW1\\BIOS-HW1\\Exercise.csv", skip = 1)

```

Change the labels.

```{r labels}

my_labels <- list(Age = "Age (yrs)", Gender = "Gender", Race = "Race", HTN = "Hypertensive", T2DM = "Type 2 Diabetes", Depression = "Depression", Smokes = "Smoker")
```

Clean the output.

```{r clean output}
my_controls <- tableby.control(
               total = FALSE,
               test = FALSE,  # No test p-values yet
               numeric.stats = c("meansd", "medianq1q3"),
               cat.stats = c("countpct"),
               stats.labels = list(
               meansd = "Mean (SD)",
               medianq1q3 = "Median (Q1, Q3)",
               countpct = "N (%)"))
```

I found a function called mutate from recitation that is useful for showing categories. No idea why it works.

```{r categories}

table1 <- exercise %>%
  mutate(Group = factor(Group, labels = c("Intervention","Control"))) %>%
  mutate(Gender = factor(Gender, labels = c("Male", "Female"))) %>%
  mutate(Race = factor(Race, labels = c("African American", "Hispanic", "Caucasian"))) %>%
  mutate(HTN = factor(HTN, labels = c("Yes","No"))) %>%
  mutate(T2DM = factor(T2DM, labels = c("Yes", "No"))) %>%
  mutate(Depression = factor(Depression, labels = c("Yes","No"))) %>%
  mutate(Smokes = factor(Smokes,labels = c("Yes","No")))
```

This is a first table.

```{r solution 1a}
solution1a <- tableby(Group ~ Age + Gender + Race + HTN + T2DM + Depression + Smokes, 
                      data = table1, control = my_controls)
```

This is a solution.

```{r output 1a}
summary(solution1a, title = "Demographics and Co-Morbidities", labelTranslations = my_labels,text = TRUE)

```

## Section 1b

This is a solution for Section 1b.

Start with the labels.

```{r labels2}

my_labels2 <- list(PRE = "Systolic Blood Pressure (mm Hg)", POST = " ",
                   PRE.1 = "Diastolic Blood Pressure (mm Hg)", POST.1 = " ",
                   PRE.2 = "Body Mass Index", POST.2 = " ",
                   PRE.3 = "HDL Cholesterol", POST.3 = " ",
                   PRE.4 = "LDL Cholesterol", POST.4 = " ",
                   PRE.5 = "Blood Glucose (mmol/L)", POST.5 = " ")
```


```{r categories2}
table2 <- exercise %>%
  mutate(Group = factor(Group, labels = c("Intervention", "Control")))
```

Clean the output.

```{r controls2}
my_controls2 <- tableby.control(
               total = FALSE,
               test = FALSE,  # No test p-values yet
               numeric.stats = c("meansd", "medianq1q3"),
               cat.stats = c("countpct"),
               stats.labels = list(
               meansd = "Mean (SD)",
               medianq1q3 = "Median (Q1, Q3)",
               countpct = "N (%)"))
```

Use only the variables we are looking at.

```{r table2}
solution1b <- tableby(Group ~ PRE + POST + PRE.1 + POST.1 + 
                        PRE.2 + POST.2 + PRE.3 + POST.3 + 
                        PRE.4 + POST.4 + PRE.5 + POST.5,
                      data = table2, control = my_controls2)
```

Make a table.

```{r solution2a}
summary(solution1b, title="Metabolic Parameters", labelTranslations = my_labels2, text=TRUE)
```

Create a dataframe that splits data by factor.

```{r split data by factor, eval=FALSE}

# exp <- factor(table2$Group)

df_good <- exercise %>% group_by(Group)

df_good %>% summarize(
  pre = mean(PRE),
  post = mean(POST),
  pre.1 = mean(PRE.1),
  post.1 = mean(POST.1),
  pre.2 = mean(PRE.2),
  post.2 = mean(POST.2),
  pre.3 = mean(PRE.3),
  post.3 = mean(POST.3),
  pre.4 = mean(PRE.4),
  post.4 = mean(POST.4),
  pre.5 = mean(PRE.5),
  post.5 = mean(POST.5),
) -> df_use
```

```{r df, eval = FALSE}
mp_df <- df_good %>% tibble(
  Sys_u = mean(PRE), 
  Sys_sd = sd(PRE),
  Sys_u2 = mean(POST), 
  Sys_sd2 = sd(POST)
)
```

```{r, eval=FALSE}
groupsys1 <- tableby(Group ~ PRE, data=table2, control = my_controls2)
groupsys2 <- tableby(Group ~ POST, data=table2, control = my_controls2)
#groupdia1 <- tableby(Group ~ PRE.1, data=table2, control = my_controls2)
#groupdia2 <- tableby(Group ~ POST, data=table2, control = my_controls2)
#groupbmi1 <- tableby(Group ~ PRE, data=table2, control = my_controls2)
#groupbmi2 <- tableby(Group ~ POST, data=table2, control = my_controls2)
#grouphdl1 <- tableby(Group ~ PRE, data=table2, control = my_controls2)
#grouphdl2 <- tableby(Group ~ POST, data=table2, control = my_controls2)
#groupldl1 <- tableby(Group ~ PRE, data=table2, control = my_controls2)
#groupldl2 <- tableby(Group ~ POST, data=table2, control = my_controls2)
#groupglu1 <- tableby(Group ~ PRE, data=table2, control = my_controls2)
#groupglu2 <- tableby(Group ~ POST, data=table2, control = my_controls2)
```

```{r, eval=FALSE}
table1 <- summary(groupsys1, title="Systolic Blood Pressure", labelTranslations = my_labels2, text=TRUE)
table2 <- summary(groupsys2, title="Systolic Blood Pressure 6-months", labelTranslations = my_labels2, text=TRUE)
kable(list(table1, table2))
```

```{r Pipes}
new_df <- select(exercise,Group,PRE,POST,PRE.1,POST.1,PRE.2,POST.2,PRE.3,POST.3,PRE.4,POST.4,PRE.5,POST.5)
new_df1 <- filter(new_df, Group == 1)
new_df2 <- filter(new_df, Group == 0)
```

```{r, eval=FALSE}
--- | Intervention |         | Control |     |    
--- | ------------ | ------- | ------- | --- |
--- | Baseline | 6-months | Baseline | 6-months
Systolic Blood Pressure (mm Hg) | `r mean()` +/- `r sd(groupsys1)` | `r mean(groupsys1)` +/- `r sd(groupsys1)` | `r mean(groupsys1)` +/- `r sd(groupsys1)` | `r mean(groupsys1)` +/- `r sd(groupsys1)`
```